
<!doctype HTML>
<head>
  <title>Tree-sitter Highlighting</title>
  <style>
    body {
      font-family: monospace
    }
    .line-number {
      user-select: none;
      text-align: right;
      color: rgba(27,31,35,.3);
      padding: 0 10px;
    }
    .line {
      white-space: pre;
    }
  </style>
</head>
<body>

<table>
<tr><td class=line-number>1</td><td class=line>#import <span style='color: #008700;'>&quot;Basic&quot;</span>;
</td></tr>
<tr><td class=line-number>2</td><td class=line>
</td></tr>
<tr><td class=line-number>3</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// XXX Incomplete: Talk about structs having a namespace.</span>
</td></tr>
<tr><td class=line-number>4</td><td class=line>
</td></tr>
<tr><td class=line-number>5</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// Mental Organization</span>
</td></tr>
<tr><td class=line-number>6</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// Physical Organization</span>
</td></tr>
<tr><td class=line-number>7</td><td class=line>
</td></tr>
<tr><td class=line-number>8</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// XXX Organization: passing many elements around.</span>
</td></tr>
<tr><td class=line-number>9</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>/*</span>
</td></tr>
<tr><td class=line-number>10</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>11</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  This language also has structs, which are collections of other data types</span>
</td></tr>
<tr><td class=line-number>12</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  packed together. These are mostly the same as structs in C, if you are familiar</span>
</td></tr>
<tr><td class=line-number>13</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  with those.</span>
</td></tr>
<tr><td class=line-number>14</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>15</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  The reason you&#39;d collect values together in a struct is for purposes of organization.</span>
</td></tr>
<tr><td class=line-number>16</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  Structs help you think about what your program is trying to accomplish, by grouping</span>
</td></tr>
<tr><td class=line-number>17</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  smaller variables together in a way that engages the human mind&#39;s ability to &quot;chunk&quot;</span>
</td></tr>
<tr><td class=line-number>18</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  concepts together. In this way they help you see a program in your mind.</span>
</td></tr>
<tr><td class=line-number>19</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>20</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  As an example, suppose you want to store information about people you know. You might</span>
</td></tr>
<tr><td class=line-number>21</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  put that information together into a struct:</span>
</td></tr>
<tr><td class=line-number>22</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>23</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>*/</span>
</td></tr>
<tr><td class=line-number>24</td><td class=line>
</td></tr>
<tr><td class=line-number>25</td><td class=line><span style='font-weight: bold;color: cyan;'>Person</span> :: <span style='color: #005f5f;'>struct</span> {
</td></tr>
<tr><td class=line-number>26</td><td class=line>    <span style='color: blue;'>name</span>:         <span style='color: #005f5f;'>string</span>;
</td></tr>
<tr><td class=line-number>27</td><td class=line>    <span style='color: blue;'>address</span>:      Address;
</td></tr>
<tr><td class=line-number>28</td><td class=line>    <span style='color: blue;'>phone_number</span>: Phone_Number;
</td></tr>
<tr><td class=line-number>29</td><td class=line>    <span style='color: blue;'>year_born</span>:    <span style='color: #005f5f;'>int</span>;
</td></tr>
<tr><td class=line-number>30</td><td class=line>    <span style='color: blue;'>month_born</span>:   <span style='color: #005f5f;'>int</span>;
</td></tr>
<tr><td class=line-number>31</td><td class=line>    <span style='color: blue;'>day_born</span>:     <span style='color: #005f5f;'>int</span>;
</td></tr>
<tr><td class=line-number>32</td><td class=line>}
</td></tr>
<tr><td class=line-number>33</td><td class=line>
</td></tr>
<tr><td class=line-number>34</td><td class=line><span style='font-weight: bold;color: cyan;'>Address</span> :: <span style='color: #005f5f;'>struct</span> {
</td></tr>
<tr><td class=line-number>35</td><td class=line>    <span style='color: blue;'>street_number</span>: <span style='color: #005f5f;'>int</span>;
</td></tr>
<tr><td class=line-number>36</td><td class=line>    <span style='color: blue;'>street_name</span>:   <span style='color: #005f5f;'>string</span>;
</td></tr>
<tr><td class=line-number>37</td><td class=line>}
</td></tr>
<tr><td class=line-number>38</td><td class=line>
</td></tr>
<tr><td class=line-number>39</td><td class=line><span style='color: #875f00;'>Phone_Number</span> :: [<span style='font-weight: bold;color: #875f00;'>9</span>] <span style='color: #005f5f;'>u8</span>;
</td></tr>
<tr><td class=line-number>40</td><td class=line>
</td></tr>
<tr><td class=line-number>41</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>/*</span>
</td></tr>
<tr><td class=line-number>42</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>43</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  and so forth. Then, you can just think of your program as something that manipulates</span>
</td></tr>
<tr><td class=line-number>44</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  these batches of information about people, without having to think about all the</span>
</td></tr>
<tr><td class=line-number>45</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  individual pieces of information like address and phone_number as having separate</span>
</td></tr>
<tr><td class=line-number>46</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  and very divergent existences.</span>
</td></tr>
<tr><td class=line-number>47</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>48</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  You can write procedures that take a Person as an argument, instead of a bunch of</span>
</td></tr>
<tr><td class=line-number>49</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  loose fields. You can assign a variable of type Person to another variable of type</span>
</td></tr>
<tr><td class=line-number>50</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  Person.</span>
</td></tr>
<tr><td class=line-number>51</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>52</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  In addition to this mental organization, structs also perform physical organization:</span>
</td></tr>
<tr><td class=line-number>53</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  they control how the memory, that stores all the struct&#39;s fields, is laid out. </span>
</td></tr>
<tr><td class=line-number>54</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  We&#39;ll talk about this in more detail later on, but it&#39;s worth mentioning here. </span>
</td></tr>
<tr><td class=line-number>55</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>56</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  Some might say that it&#39;s confusing for structs to be performing these two different</span>
</td></tr>
<tr><td class=line-number>57</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  tasks that ought to be orthogonal. As an example, people from &#39;functional language&#39; schools</span>
</td></tr>
<tr><td class=line-number>58</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  of thought might say that &quot;implementation should be totally decoupled from semantics&quot;:</span>
</td></tr>
<tr><td class=line-number>59</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  that the way data is stored doesn&#39;t really matter, and the compiler should take care of that,</span>
</td></tr>
<tr><td class=line-number>60</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  and you should concern yourself with the mental part, and ignore the physical part, because</span>
</td></tr>
<tr><td class=line-number>61</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  that means you as the programmer don&#39;t have to think about as many things, which </span>
</td></tr>
<tr><td class=line-number>62</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  means you are doing less work.</span>
</td></tr>
<tr><td class=line-number>63</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>64</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  That sounds good, but things rarely work that way in reality, unless you are talking about</span>
</td></tr>
<tr><td class=line-number>65</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  programming languages for beginners, or for people who are not themselves</span>
</td></tr>
<tr><td class=line-number>66</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  professional programmers, and just want to do some programming incidentally so that they </span>
</td></tr>
<tr><td class=line-number>67</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  can get some other work done, like scientific research, or customizing the behavior of</span>
</td></tr>
<tr><td class=line-number>68</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  some overly-complex piece of software. </span>
</td></tr>
<tr><td class=line-number>69</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>70</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  In reality, compilers just aren&#39;t very smart, and any decisions they make regarding</span>
</td></tr>
<tr><td class=line-number>71</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  data layout are not going to be as good as the choices that would be made by a skilled</span>
</td></tr>
<tr><td class=line-number>72</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  programmer who is experienced at laying out data. So there is nearly no benefit to</span>
</td></tr>
<tr><td class=line-number>73</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  rearranging the way things are stored in a struct; so it actually makes programs simpler</span>
</td></tr>
<tr><td class=line-number>74</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  when the compiler doesn&#39;t do this. Because if structs can be rearranged, there are</span>
</td></tr>
<tr><td class=line-number>75</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  two concepts in play: the mental order of the struct, and the physical order of the struct,</span>
</td></tr>
<tr><td class=line-number>76</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  and to understand what is actually happening on the computer, you need to know both of these.</span>
</td></tr>
<tr><td class=line-number>77</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  Furthermore, there are added complications that can happen, for example, maybe the compiler</span>
</td></tr>
<tr><td class=line-number>78</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  makes different choices about how to lay out a struct between one run and the next, and this</span>
</td></tr>
<tr><td class=line-number>79</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  surprises you when your program gets appreciably slower for no reason you can see (and no</span>
</td></tr>
<tr><td class=line-number>80</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  reason under your control to fix).</span>
</td></tr>
<tr><td class=line-number>81</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>82</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  On the other hand, if the conceptual and physical orders are the same, you only </span>
</td></tr>
<tr><td class=line-number>83</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  need to know one thing, and it will never change.</span>
</td></tr>
<tr><td class=line-number>84</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>85</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  Furthermore, when programs are efficient, the conceptual order and the physical order</span>
</td></tr>
<tr><td class=line-number>86</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  tend to be the same naturally. There are lots of strange ideas about how to program,</span>
</td></tr>
<tr><td class=line-number>87</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  for example &quot;Object Oriented Programming&quot;, where it is often taught to beginners that</span>
</td></tr>
<tr><td class=line-number>88</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  you should choose data structures that reflect a physical object&#39;s behavior in the real world.</span>
</td></tr>
<tr><td class=line-number>89</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  (This is a misunderstanding of OOP propagated by teachers who are insufficiently experienced</span>
</td></tr>
<tr><td class=line-number>90</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  at programming, but nevertheless, it is what actually happens in many schools).</span>
</td></tr>
<tr><td class=line-number>91</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  If you do this, programs often become complicated quickly, because the operations you want</span>
</td></tr>
<tr><td class=line-number>92</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  to perform on the objects&#39; data do not seem to align very well with the operations</span>
</td></tr>
<tr><td class=line-number>93</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  that you would abstractly think of as occurring in the Real World. (This is hard to explain</span>
</td></tr>
<tr><td class=line-number>94</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  without a concrete example, and this explanation is already pretty long, so we&#39;ll leave this</span>
</td></tr>
<tr><td class=line-number>95</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  statement somewhat vague for now.)</span>
</td></tr>
<tr><td class=line-number>96</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>97</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  When programs are efficient, both in terms of speed and in terms of structural simplicity, </span>
</td></tr>
<tr><td class=line-number>98</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  data structures are actually designed around the job that the computer is physically </span>
</td></tr>
<tr><td class=line-number>99</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  trying to do. Because what matters to you as the programmer is not what an average person</span>
</td></tr>
<tr><td class=line-number>100</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  off the street thinks should be happening with some conceptual object, but rather,</span>
</td></tr>
<tr><td class=line-number>101</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  what you know a computer needs to do in order to successfully perform complex algorithms.</span>
</td></tr>
<tr><td class=line-number>102</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  As programmers get more experienced, they learn to think about programs such that the </span>
</td></tr>
<tr><td class=line-number>103</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  collections of data in the code -- the things you would build structs around -- are naturally</span>
</td></tr>
<tr><td class=line-number>104</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  the things that the program wants to manipulate most directly. Because that&#39;s your job,</span>
</td></tr>
<tr><td class=line-number>105</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  to make sure the program correctly manipulates the data.</span>
</td></tr>
<tr><td class=line-number>106</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>107</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  Specifying the physical layout of the data, and it being the same as the conceptual layout</span>
</td></tr>
<tr><td class=line-number>108</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>  of the data, is exactly what the programmer wants at this stage of experience.</span>
</td></tr>
<tr><td class=line-number>109</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>110</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>*/</span>
</td></tr>
<tr><td class=line-number>111</td><td class=line>
</td></tr>
<tr><td class=line-number>112</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// The following is a struct for an axis-aligned rectangle:</span>
</td></tr>
<tr><td class=line-number>113</td><td class=line>
</td></tr>
<tr><td class=line-number>114</td><td class=line><span style='font-weight: bold;color: cyan;'>Rectangle</span> :: <span style='color: #005f5f;'>struct</span> {  <span style='font-style: italic;color: #8a8a8a;'>// It is my personal style to capitalize the names of my structs, but it&#39;s not required.</span>
</td></tr>
<tr><td class=line-number>115</td><td class=line>    <span style='color: blue;'>x0</span>: <span style='color: #005f5f;'>float</span>;   <span style='font-style: italic;color: #8a8a8a;'>// X coordinate of lower-left corner.</span>
</td></tr>
<tr><td class=line-number>116</td><td class=line>    <span style='color: blue;'>y0</span>: <span style='color: #005f5f;'>float</span>;   <span style='font-style: italic;color: #8a8a8a;'>// Y coordinate of lower-left corner.</span>
</td></tr>
<tr><td class=line-number>117</td><td class=line>    <span style='color: blue;'>x1</span>: <span style='color: #005f5f;'>float</span>;   <span style='font-style: italic;color: #8a8a8a;'>// X coordinate of upper-right corner.</span>
</td></tr>
<tr><td class=line-number>118</td><td class=line>    <span style='color: blue;'>y1</span>: <span style='color: #005f5f;'>float</span>;   <span style='font-style: italic;color: #8a8a8a;'>// Y coordinate of upper-right corner.</span>
</td></tr>
<tr><td class=line-number>119</td><td class=line>
</td></tr>
<tr><td class=line-number>120</td><td class=line>    <span style='color: blue;'>color_name</span>: <span style='color: #005f5f;'>string</span>;   <span style='font-style: italic;color: #8a8a8a;'>// Maybe the name of a color we use to draw this, or ... something.</span>
</td></tr>
<tr><td class=line-number>121</td><td class=line>}
</td></tr>
<tr><td class=line-number>122</td><td class=line>
</td></tr>
<tr><td class=line-number>123</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// You may often want code to look at these values at the same time, for drawing rectangles,</span>
</td></tr>
<tr><td class=line-number>124</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// testing the mouse pointer against their coordinates, saving and loading rectangles, and</span>
</td></tr>
<tr><td class=line-number>125</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// so forth.</span>
</td></tr>
<tr><td class=line-number>126</td><td class=line>
</td></tr>
<tr><td class=line-number>127</td><td class=line><span style='color: #ffd787;'>main</span> :: () {
</td></tr>
<tr><td class=line-number>128</td><td class=line>    <span style='color: blue;'>r</span>: <span style='font-weight: bold;color: cyan;'>Rectangle</span>;   <span style='font-style: italic;color: #8a8a8a;'>// This declares a Rectangle on the stack. All its members are initialized to their default values.</span>
</td></tr>
<tr><td class=line-number>129</td><td class=line>
</td></tr>
<tr><td class=line-number>130</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// We can print the entire struct very easily; the print function will show us all its members:</span>
</td></tr>
<tr><td class=line-number>131</td><td class=line>
</td></tr>
<tr><td class=line-number>132</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;Initially, r is: %\n&quot;</span>, <span style='color: blue;'>r</span>);
</td></tr>
<tr><td class=line-number>133</td><td class=line>
</td></tr>
<tr><td class=line-number>134</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Let&#39;s set some of the members.</span>
</td></tr>
<tr><td class=line-number>135</td><td class=line>
</td></tr>
<tr><td class=line-number>136</td><td class=line>    <span style='color: blue;'>r</span>.<span style='color: blue;'>x0</span> = <span style='font-weight: bold;color: #875f00;'>10</span>;
</td></tr>
<tr><td class=line-number>137</td><td class=line>    <span style='color: blue;'>r</span>.<span style='color: blue;'>y0</span> = <span style='font-weight: bold;color: #875f00;'>5</span>;
</td></tr>
<tr><td class=line-number>138</td><td class=line>    <span style='color: blue;'>r</span>.<span style='color: blue;'>x1</span> = <span style='font-weight: bold;color: #875f00;'>50</span>;
</td></tr>
<tr><td class=line-number>139</td><td class=line>    <span style='color: blue;'>r</span>.<span style='color: blue;'>y1</span> = <span style='font-weight: bold;color: #875f00;'>55</span>;
</td></tr>
<tr><td class=line-number>140</td><td class=line>
</td></tr>
<tr><td class=line-number>141</td><td class=line>    <span style='color: blue;'>r</span>.<span style='color: blue;'>color_name</span> = <span style='color: #008700;'>&quot;chartreuse&quot;</span>;
</td></tr>
<tr><td class=line-number>142</td><td class=line>
</td></tr>
<tr><td class=line-number>143</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;Later, r is: %\n&quot;</span>, <span style='color: blue;'>r</span>);
</td></tr>
<tr><td class=line-number>144</td><td class=line>
</td></tr>
<tr><td class=line-number>145</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>146</td><td class=line>    
</td></tr>
<tr><td class=line-number>147</td><td class=line>    <span style='color: blue;'>foo</span> := <span style='font-weight: bold;color: #875f00;'>3</span>;
</td></tr>
<tr><td class=line-number>148</td><td class=line>    
</td></tr>
<tr><td class=line-number>149</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Structs are stored in memory in the order in which their members are declared,</span>
</td></tr>
<tr><td class=line-number>150</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// with no surprises. Thus if you write a struct to a file, or copy it to somewhere</span>
</td></tr>
<tr><td class=line-number>151</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// else in memory, you have a good idea what is happening.</span>
</td></tr>
<tr><td class=line-number>152</td><td class=line>
</td></tr>
<tr><td class=line-number>153</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// This is different from the idea in some other programming languages, where data structures</span>
</td></tr>
<tr><td class=line-number>154</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// are specified semantically, but not in terms of implementation: the compiler could move</span>
</td></tr>
<tr><td class=line-number>155</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// members around, or something like that. In this language, that&#39;s prohibited. The order</span>
</td></tr>
<tr><td class=line-number>156</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// in which you declare members of the struct, along with their types, uniquely determines</span>
</td></tr>
<tr><td class=line-number>157</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// the placement of each member. This placement does not depend on the target platform</span>
</td></tr>
<tr><td class=line-number>158</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// or any other implementation detail that would change behind your back. Thus it&#39;s very</span>
</td></tr>
<tr><td class=line-number>159</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// simple and will not make you worry.</span>
</td></tr>
<tr><td class=line-number>160</td><td class=line>    
</td></tr>
<tr><td class=line-number>161</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Later we will talk about advanced struct stuff like controlling alignment and initialization,</span>
</td></tr>
<tr><td class=line-number>162</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// but for now, you can see how things are stored in memory relative to the address where</span>
</td></tr>
<tr><td class=line-number>163</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// the struct begins:</span>
</td></tr>
<tr><td class=line-number>164</td><td class=line>
</td></tr>
<tr><td class=line-number>165</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// The unary * operator means you&#39;re taking the address of a value: the memory location where</span>
</td></tr>
<tr><td class=line-number>166</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// that value is stored.</span>
</td></tr>
<tr><td class=line-number>167</td><td class=line>    
</td></tr>
<tr><td class=line-number>168</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Since r is a struct, *r means the memory address at which the struct r is stored.</span>
</td></tr>
<tr><td class=line-number>169</td><td class=line>    
</td></tr>
<tr><td class=line-number>170</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;The base of r is %.\n&quot;</span>, *<span style='color: blue;'>r</span>);
</td></tr>
<tr><td class=line-number>171</td><td class=line>
</td></tr>
<tr><td class=line-number>172</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;The address of r.x0 is %. (The same as r!)\n&quot;</span>, *<span style='color: blue;'>r</span>.<span style='color: blue;'>x0</span>);
</td></tr>
<tr><td class=line-number>173</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;The address of r.x1 is %.\n&quot;</span>, *<span style='color: blue;'>r</span>.<span style='color: blue;'>x1</span>);
</td></tr>
<tr><td class=line-number>174</td><td class=line>
</td></tr>
<tr><td class=line-number>175</td><td class=line>
</td></tr>
<tr><td class=line-number>176</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Bad teaching has made a lot of people scared of pointers, or convinced them</span>
</td></tr>
<tr><td class=line-number>177</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// that pointers are very mysterious.</span>
</td></tr>
<tr><td class=line-number>178</td><td class=line>
</td></tr>
<tr><td class=line-number>179</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// But in modern computers, a pointer is just an integer. It is the location in memory,</span>
</td></tr>
<tr><td class=line-number>180</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// as managed by the operating system, where the struct&#39;s data is stored. (In very rare</span>
</td></tr>
<tr><td class=line-number>181</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// computer architectures where a pointer is more complicated than one integer, it can</span>
</td></tr>
<tr><td class=line-number>182</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// still be mapped to integers straightforwardly, so don&#39;t worry about it.)</span>
</td></tr>
<tr><td class=line-number>183</td><td class=line>
</td></tr>
<tr><td class=line-number>184</td><td class=line>
</td></tr>
<tr><td class=line-number>185</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// You can assign a struct to another struct.</span>
</td></tr>
<tr><td class=line-number>186</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// It works just as you&#39;d expect:</span>
</td></tr>
<tr><td class=line-number>187</td><td class=line>
</td></tr>
<tr><td class=line-number>188</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>189</td><td class=line>    
</td></tr>
<tr><td class=line-number>190</td><td class=line>    <span style='color: blue;'>s</span> := <span style='color: blue;'>r</span>;
</td></tr>
<tr><td class=line-number>191</td><td class=line>
</td></tr>
<tr><td class=line-number>192</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;s is %\n&quot;</span>, <span style='color: blue;'>s</span>);
</td></tr>
<tr><td class=line-number>193</td><td class=line>
</td></tr>
<tr><td class=line-number>194</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>195</td><td class=line>
</td></tr>
<tr><td class=line-number>196</td><td class=line>
</td></tr>
<tr><td class=line-number>197</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// You can call a procedure with a struct as argument, again, like anything else:</span>
</td></tr>
<tr><td class=line-number>198</td><td class=line>
</td></tr>
<tr><td class=line-number>199</td><td class=line>    <span style='color: #ffd787;'>rotate_rectangle</span> :: (<span style='color: blue;'>r</span>: <span style='font-weight: bold;color: cyan;'>Rectangle</span>) -&gt; <span style='color: blue;'>s</span>: <span style='font-weight: bold;color: cyan;'>Rectangle</span> {
</td></tr>
<tr><td class=line-number>200</td><td class=line>        <span style='color: blue;'>s</span>: <span style='font-weight: bold;color: cyan;'>Rectangle</span>;
</td></tr>
<tr><td class=line-number>201</td><td class=line>        <span style='color: blue;'>s</span>.<span style='color: blue;'>color_name</span> = <span style='color: blue;'>r</span>.<span style='color: blue;'>color_name</span>;  <span style='font-style: italic;color: #8a8a8a;'>// Don&#39;t change the color!</span>
</td></tr>
<tr><td class=line-number>202</td><td class=line>
</td></tr>
<tr><td class=line-number>203</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// Rotate the rectangle by 90 degrees counterclockwise around the origin.</span>
</td></tr>
<tr><td class=line-number>204</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// note that after you do this, these points no longer represent the</span>
</td></tr>
<tr><td class=line-number>205</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// lower-left and upper-right corners, so maybe this function</span>
</td></tr>
<tr><td class=line-number>206</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// is a bad idea, but it&#39;s just an example.</span>
</td></tr>
<tr><td class=line-number>207</td><td class=line>        
</td></tr>
<tr><td class=line-number>208</td><td class=line>        <span style='color: blue;'>s</span>.<span style='color: blue;'>x0</span> = -<span style='color: blue;'>r</span>.<span style='color: blue;'>y0</span>;
</td></tr>
<tr><td class=line-number>209</td><td class=line>        <span style='color: blue;'>s</span>.<span style='color: blue;'>x1</span> = -<span style='color: blue;'>r</span>.<span style='color: blue;'>y1</span>;
</td></tr>
<tr><td class=line-number>210</td><td class=line>        <span style='color: blue;'>s</span>.<span style='color: blue;'>y0</span> =  <span style='color: blue;'>r</span>.<span style='color: blue;'>x0</span>;
</td></tr>
<tr><td class=line-number>211</td><td class=line>        <span style='color: blue;'>s</span>.<span style='color: blue;'>y1</span> =  <span style='color: blue;'>r</span>.<span style='color: blue;'>x1</span>;
</td></tr>
<tr><td class=line-number>212</td><td class=line>        
</td></tr>
<tr><td class=line-number>213</td><td class=line>        <span style='color: #5f00d7;'>return</span> <span style='color: blue;'>s</span>;
</td></tr>
<tr><td class=line-number>214</td><td class=line>    }
</td></tr>
<tr><td class=line-number>215</td><td class=line>
</td></tr>
<tr><td class=line-number>216</td><td class=line>    <span style='color: blue;'>other_r</span> := <span style='color: #ffd787;'><span style='color: #ffd787;'>rotate_rectangle</span></span>(<span style='color: blue;'>r</span>);
</td></tr>
<tr><td class=line-number>217</td><td class=line>    
</td></tr>
<tr><td class=line-number>218</td><td class=line>
</td></tr>
<tr><td class=line-number>219</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Structs can be defined locally to a procedure, like right here:</span>
</td></tr>
<tr><td class=line-number>220</td><td class=line>
</td></tr>
<tr><td class=line-number>221</td><td class=line>    <span style='font-weight: bold;color: cyan;'>Vector3</span> :: <span style='color: #005f5f;'>struct</span> {
</td></tr>
<tr><td class=line-number>222</td><td class=line>        <span style='color: blue;'>x</span>, <span style='color: blue;'>y</span>, <span style='color: blue;'>z</span>: <span style='color: #005f5f;'>float</span>;  <span style='font-style: italic;color: #8a8a8a;'>// Compound declaration: all of x, y, and z are floats.</span>
</td></tr>
<tr><td class=line-number>223</td><td class=line>    }
</td></tr>
<tr><td class=line-number>224</td><td class=line>
</td></tr>
<tr><td class=line-number>225</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Structs can contain other structs:</span>
</td></tr>
<tr><td class=line-number>226</td><td class=line>
</td></tr>
<tr><td class=line-number>227</td><td class=line>    <span style='font-weight: bold;color: cyan;'>Line_Segment</span> :: <span style='color: #005f5f;'>struct</span> {
</td></tr>
<tr><td class=line-number>228</td><td class=line>        <span style='color: blue;'>start</span>: <span style='font-weight: bold;color: cyan;'>Vector3</span>;
</td></tr>
<tr><td class=line-number>229</td><td class=line>        <span style='color: blue;'>end</span>:   <span style='font-weight: bold;color: cyan;'>Vector3</span>;
</td></tr>
<tr><td class=line-number>230</td><td class=line>        <span style='color: blue;'>color</span>: <span style='color: #005f5f;'>string</span>;
</td></tr>
<tr><td class=line-number>231</td><td class=line>    }
</td></tr>
<tr><td class=line-number>232</td><td class=line>
</td></tr>
<tr><td class=line-number>233</td><td class=line>
</td></tr>
<tr><td class=line-number>234</td><td class=line>    <span style='color: blue;'>segment</span>: <span style='font-weight: bold;color: cyan;'>Line_Segment</span>;
</td></tr>
<tr><td class=line-number>235</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;segment is: %\n&quot;</span>, <span style='color: blue;'>segment</span>);
</td></tr>
<tr><td class=line-number>236</td><td class=line>
</td></tr>
<tr><td class=line-number>237</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>238</td><td class=line>    
</td></tr>
<tr><td class=line-number>239</td><td class=line>
</td></tr>
<tr><td class=line-number>240</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// You can set default values for struct members, just using the same</span>
</td></tr>
<tr><td class=line-number>241</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// declaration syntax you would use for declaring local variables:</span>
</td></tr>
<tr><td class=line-number>242</td><td class=line>
</td></tr>
<tr><td class=line-number>243</td><td class=line>    <span style='font-weight: bold;color: cyan;'>Ice_Cream_Info</span> :: <span style='color: #005f5f;'>struct</span> {
</td></tr>
<tr><td class=line-number>244</td><td class=line>        <span style='color: blue;'>temperature</span> := <span style='font-weight: bold;color: #875f00;'>-10.0</span>;
</td></tr>
<tr><td class=line-number>245</td><td class=line>        <span style='color: blue;'>flavor</span>      := <span style='color: #008700;'>&quot;vanilla&quot;</span>;
</td></tr>
<tr><td class=line-number>246</td><td class=line>        <span style='color: blue;'>num_scoops</span>  := <span style='font-weight: bold;color: #875f00;'>2</span>;
</td></tr>
<tr><td class=line-number>247</td><td class=line>    }
</td></tr>
<tr><td class=line-number>248</td><td class=line>    
</td></tr>
<tr><td class=line-number>249</td><td class=line>    <span style='color: blue;'>serving1</span>: <span style='font-weight: bold;color: cyan;'>Ice_Cream_Info</span>;   <span style='font-style: italic;color: #8a8a8a;'>// serving1 will get the defaults.</span>
</td></tr>
<tr><td class=line-number>250</td><td class=line>
</td></tr>
<tr><td class=line-number>251</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;serving1 is: %\n&quot;</span>, <span style='color: blue;'>serving1</span>);
</td></tr>
<tr><td class=line-number>252</td><td class=line>
</td></tr>
<tr><td class=line-number>253</td><td class=line>    <span style='color: blue;'>serving2</span>: <span style='font-weight: bold;color: cyan;'>Ice_Cream_Info</span>;   <span style='font-style: italic;color: #8a8a8a;'>// serving2 will get the defaults, but then we will change some!</span>
</td></tr>
<tr><td class=line-number>254</td><td class=line>    <span style='color: blue;'>serving2</span>.<span style='color: blue;'>temperature</span> = <span style='font-weight: bold;color: #875f00;'>-17.8</span>;
</td></tr>
<tr><td class=line-number>255</td><td class=line>    <span style='color: blue;'>serving2</span>.<span style='color: blue;'>flavor</span>      = <span style='color: #008700;'>&quot;peppermint&quot;</span>;
</td></tr>
<tr><td class=line-number>256</td><td class=line>    
</td></tr>
<tr><td class=line-number>257</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;serving2 is: %\n&quot;</span>, <span style='color: blue;'>serving2</span>);
</td></tr>
<tr><td class=line-number>258</td><td class=line>    
</td></tr>
<tr><td class=line-number>259</td><td class=line>
</td></tr>
<tr><td class=line-number>260</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// You can even set default values of sub-structs inside a struct, using an = operation.</span>
</td></tr>
<tr><td class=line-number>261</td><td class=line>
</td></tr>
<tr><td class=line-number>262</td><td class=line>    <span style='font-weight: bold;color: cyan;'>Ice_Cream_Store_Display</span> :: <span style='color: #005f5f;'>struct</span> {
</td></tr>
<tr><td class=line-number>263</td><td class=line>        <span style='color: blue;'>brightness</span>: <span style='color: #005f5f;'>float</span>;
</td></tr>
<tr><td class=line-number>264</td><td class=line>
</td></tr>
<tr><td class=line-number>265</td><td class=line>        <span style='color: blue;'>info</span>: <span style='font-weight: bold;color: cyan;'>Ice_Cream_Info</span>;       <span style='font-style: italic;color: #8a8a8a;'>// Use the default ice cream info...</span>
</td></tr>
<tr><td class=line-number>266</td><td class=line>        <span style='color: blue;'>info</span>.<span style='color: blue;'>flavor</span> = <span style='color: #008700;'>&quot;chocolate&quot;</span>;  <span style='font-style: italic;color: #8a8a8a;'>// But set the flavor to chocolate! But leave the rest of the defaults.</span>
</td></tr>
<tr><td class=line-number>267</td><td class=line>
</td></tr>
<tr><td class=line-number>268</td><td class=line>        <span style='color: blue;'>position</span>: <span style='font-weight: bold;color: cyan;'>Vector3</span>;
</td></tr>
<tr><td class=line-number>269</td><td class=line>        <span style='color: blue;'>position</span>.<span style='color: blue;'>z</span> = <span style='font-weight: bold;color: #875f00;'>1.5</span>;           <span style='font-style: italic;color: #8a8a8a;'>// Raise up the display in Z.</span>
</td></tr>
<tr><td class=line-number>270</td><td class=line>
</td></tr>
<tr><td class=line-number>271</td><td class=line>        <span style='color: blue;'>brightness</span> = <span style='font-weight: bold;color: #875f00;'>101.2</span>;         <span style='font-style: italic;color: #8a8a8a;'>// Kind of goofy to declare brightness up top then set it down here, but there you go.</span>
</td></tr>
<tr><td class=line-number>272</td><td class=line>    }
</td></tr>
<tr><td class=line-number>273</td><td class=line>
</td></tr>
<tr><td class=line-number>274</td><td class=line>
</td></tr>
<tr><td class=line-number>275</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>276</td><td class=line>    
</td></tr>
<tr><td class=line-number>277</td><td class=line>    <span style='color: blue;'>display</span>: <span style='font-weight: bold;color: cyan;'>Ice_Cream_Store_Display</span>;
</td></tr>
<tr><td class=line-number>278</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;display is: %\n&quot;</span>, <span style='color: blue;'>display</span>);
</td></tr>
<tr><td class=line-number>279</td><td class=line>    
</td></tr>
<tr><td class=line-number>280</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>281</td><td class=line>
</td></tr>
<tr><td class=line-number>282</td><td class=line>
</td></tr>
<tr><td class=line-number>283</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Maybe &#39;using&#39; should be in its own file, but:</span>
</td></tr>
<tr><td class=line-number>284</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// You can use the keyword &#39;using&#39; to locally manipulate the variables</span>
</td></tr>
<tr><td class=line-number>285</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// in a struct. For example, if I want to start messing around with</span>
</td></tr>
<tr><td class=line-number>286</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// &#39;display&#39; in a short-hand manner, I can do the following:</span>
</td></tr>
<tr><td class=line-number>287</td><td class=line>
</td></tr>
<tr><td class=line-number>288</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// First, let&#39;s open up a new scope to keep the names from the &#39;using&#39; contained,</span>
</td></tr>
<tr><td class=line-number>289</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// so they don&#39;t mess with our main routine here:</span>
</td></tr>
<tr><td class=line-number>290</td><td class=line>
</td></tr>
<tr><td class=line-number>291</td><td class=line>    {
</td></tr>
<tr><td class=line-number>292</td><td class=line>        <span style='color: #5f00d7;'>using</span> <span style='color: blue;'>display</span>;   <span style='font-style: italic;color: #8a8a8a;'>// Now all display&#39;s members are local names for us.</span>
</td></tr>
<tr><td class=line-number>293</td><td class=line>
</td></tr>
<tr><td class=line-number>294</td><td class=line>        <span style='color: blue;'>brightness</span> = <span style='font-weight: bold;color: #875f00;'>375.4</span>;           <span style='font-style: italic;color: #8a8a8a;'>// The same as saying display.brightness = 375.4;</span>
</td></tr>
<tr><td class=line-number>295</td><td class=line>
</td></tr>
<tr><td class=line-number>296</td><td class=line>        <span style='color: blue;'>info</span>.<span style='color: blue;'>flavor</span> = <span style='color: #008700;'>&quot;strawberry&quot;</span>;   <span style='font-style: italic;color: #8a8a8a;'>// The same as saying display.info.flavor = etc.</span>
</td></tr>
<tr><td class=line-number>297</td><td class=line>
</td></tr>
<tr><td class=line-number>298</td><td class=line>        <span style='color: blue;'>position</span>.<span style='color: blue;'>x</span> = <span style='font-weight: bold;color: #875f00;'>1</span>;
</td></tr>
<tr><td class=line-number>299</td><td class=line>
</td></tr>
<tr><td class=line-number>300</td><td class=line>        <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;After first using, display is: %\n&quot;</span>, <span style='color: blue;'>display</span>);
</td></tr>
<tr><td class=line-number>301</td><td class=line>
</td></tr>
<tr><td class=line-number>302</td><td class=line>        <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>303</td><td class=line>        
</td></tr>
<tr><td class=line-number>304</td><td class=line>        
</td></tr>
<tr><td class=line-number>305</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// Let&#39;s say I want to manipulate x, y, and z in super-shorthand...</span>
</td></tr>
<tr><td class=line-number>306</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// I can say using display.position, or since position is already a local name,</span>
</td></tr>
<tr><td class=line-number>307</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// I can say:</span>
</td></tr>
<tr><td class=line-number>308</td><td class=line>
</td></tr>
<tr><td class=line-number>309</td><td class=line>        <span style='color: #5f00d7;'>using</span> <span style='color: blue;'>position</span>;
</td></tr>
<tr><td class=line-number>310</td><td class=line>
</td></tr>
<tr><td class=line-number>311</td><td class=line>        <span style='color: blue;'>x</span> += <span style='font-weight: bold;color: #875f00;'>1</span>;   <span style='font-style: italic;color: #8a8a8a;'>// This is display.position.x!</span>
</td></tr>
<tr><td class=line-number>312</td><td class=line>        <span style='color: blue;'>y</span> = <span style='font-weight: bold;color: #875f00;'>-3</span>;
</td></tr>
<tr><td class=line-number>313</td><td class=line>        <span style='color: blue;'>z</span> *= <span style='font-weight: bold;color: #875f00;'>4</span>;
</td></tr>
<tr><td class=line-number>314</td><td class=line>
</td></tr>
<tr><td class=line-number>315</td><td class=line>        <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;After second using, display is: %\n&quot;</span>, <span style='color: blue;'>display</span>);
</td></tr>
<tr><td class=line-number>316</td><td class=line>
</td></tr>
<tr><td class=line-number>317</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// I don&#39;t encourage heavy use of this unless it really shortens a program, though.</span>
</td></tr>
<tr><td class=line-number>318</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// The ability to do this seems neat, but often it adds a great deal of legibility</span>
</td></tr>
<tr><td class=line-number>319</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// to your program to just dereference things fully.</span>
</td></tr>
<tr><td class=line-number>320</td><td class=line>
</td></tr>
<tr><td class=line-number>321</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// If you try to use &#39;using&#39; to import multiple variables that have the same name,</span>
</td></tr>
<tr><td class=line-number>322</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// this will be a compile-time error. We&#39;ll talk about how to avoid that later,</span>
</td></tr>
<tr><td class=line-number>323</td><td class=line>        <span style='font-style: italic;color: #8a8a8a;'>// in the special chapter on &#39;using&#39;.</span>
</td></tr>
<tr><td class=line-number>324</td><td class=line>    }
</td></tr>
<tr><td class=line-number>325</td><td class=line>
</td></tr>
<tr><td class=line-number>326</td><td class=line>    
</td></tr>
<tr><td class=line-number>327</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n\n&quot;</span>);
</td></tr>
<tr><td class=line-number>328</td><td class=line>
</td></tr>
<tr><td class=line-number>329</td><td class=line>
</td></tr>
<tr><td class=line-number>330</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// The size of a struct, measured in bytes of memory, includes enough storage for all</span>
</td></tr>
<tr><td class=line-number>331</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// its elements, including potential padding between elements. Different platforms</span>
</td></tr>
<tr><td class=line-number>332</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// may have different alignment requirements. So your struct could end up being different</span>
</td></tr>
<tr><td class=line-number>333</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// sizes on different target machines, *but*, you are able to query everything about the struct</span>
</td></tr>
<tr><td class=line-number>334</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// and know these facts at compile time.</span>
</td></tr>
<tr><td class=line-number>335</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// </span>
</td></tr>
<tr><td class=line-number>336</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Furthermore, you can control padding and alignment manually with compiler directives,</span>
</td></tr>
<tr><td class=line-number>337</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// which we&#39;ll talk about much later in a different file.</span>
</td></tr>
<tr><td class=line-number>338</td><td class=line>
</td></tr>
<tr><td class=line-number>339</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// You can use size_of to get the size.</span>
</td></tr>
<tr><td class=line-number>340</td><td class=line>    
</td></tr>
<tr><td class=line-number>341</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;size_of(Rectangle) = %\n&quot;</span>, <span style='color: #ffd787;'>size_of</span>(<span style='font-weight: bold;color: cyan;'>Rectangle</span>));
</td></tr>
<tr><td class=line-number>342</td><td class=line>
</td></tr>
<tr><td class=line-number>343</td><td class=line>
</td></tr>
<tr><td class=line-number>344</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// size_of accepts a Type as its argument. This may seem inconvenient if you are</span>
</td></tr>
<tr><td class=line-number>345</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// coming from C, where you could also pass a value.</span>
</td></tr>
<tr><td class=line-number>346</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>//</span>
</td></tr>
<tr><td class=line-number>347</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// But, this is intentional, to protect against an easily-makeable mistake.</span>
</td></tr>
<tr><td class=line-number>348</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Types are &quot;first-class&quot; in this language and we use them directly all the time.</span>
</td></tr>
<tr><td class=line-number>349</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// So, you might have some variable of type Type, and this can introduce</span>
</td></tr>
<tr><td class=line-number>350</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// ambiguities; exactly how is left as an exercise for the advanced reader.</span>
</td></tr>
<tr><td class=line-number>351</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// (If having a variable of type Type seems confusing, see the how_to file</span>
</td></tr>
<tr><td class=line-number>352</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// a little later on where we talk about this!)</span>
</td></tr>
<tr><td class=line-number>353</td><td class=line>
</td></tr>
<tr><td class=line-number>354</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// If this explanation doesn&#39;t make sense to you, don&#39;t worry about it, it&#39;s</span>
</td></tr>
<tr><td class=line-number>355</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// not important unless you want to know why you can&#39;t say size_of(r)!</span>
</td></tr>
<tr><td class=line-number>356</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Just say size_of(type_of(r)) instead.</span>
</td></tr>
<tr><td class=line-number>357</td><td class=line>    
</td></tr>
<tr><td class=line-number>358</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;size_of(type_of(r)) = %\n&quot;</span>, <span style='color: #ffd787;'>size_of</span>(<span style='color: #ffd787;'>type_of</span>(<span style='color: blue;'>r</span>)));
</td></tr>
<tr><td class=line-number>359</td><td class=line>
</td></tr>
<tr><td class=line-number>360</td><td class=line>
</td></tr>
<tr><td class=line-number>361</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// You can copy structs around in memory, manually, if you want.</span>
</td></tr>
<tr><td class=line-number>362</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Here we&#39;ll copy a struct into an array, and then back into another struct.</span>
</td></tr>
<tr><td class=line-number>363</td><td class=line>
</td></tr>
<tr><td class=line-number>364</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>365</td><td class=line>    
</td></tr>
<tr><td class=line-number>366</td><td class=line>    <span style='color: blue;'>t</span>: <span style='font-weight: bold;color: cyan;'>Rectangle</span>;
</td></tr>
<tr><td class=line-number>367</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;Before copy, t is: %\n&quot;</span>, <span style='color: blue;'>t</span>);
</td></tr>
<tr><td class=line-number>368</td><td class=line>
</td></tr>
<tr><td class=line-number>369</td><td class=line>    <span style='color: blue;'>temporary</span>: [<span style='color: #ffd787;'>size_of</span>(<span style='font-weight: bold;color: cyan;'>Rectangle</span>)] <span style='color: #005f5f;'>u8</span>;
</td></tr>
<tr><td class=line-number>370</td><td class=line>    <span style='color: #ffd787;'>memcpy</span>(<span style='color: blue;'>temporary</span>.data, *<span style='color: blue;'>r</span>, <span style='color: #ffd787;'>size_of</span>(<span style='font-weight: bold;color: cyan;'>Rectangle</span>));   <span style='font-style: italic;color: #8a8a8a;'>// Copy r&#39;s data into temporary.</span>
</td></tr>
<tr><td class=line-number>371</td><td class=line>
</td></tr>
<tr><td class=line-number>372</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>373</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;Contents of &#39;temporary&#39;, in bytes: &quot;</span>);
</td></tr>
<tr><td class=line-number>374</td><td class=line>    <span style='color: #5f00d7;'>for</span> <span style='color: blue;'>temporary</span> <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;% &quot;</span>, <span style='color: #ffd787;'>formatInt</span>(it, base=<span style='font-weight: bold;color: #875f00;'>16</span>, minimum_digits=<span style='font-weight: bold;color: #875f00;'>2</span>));  <span style='font-style: italic;color: #8a8a8a;'>// Integer formatting is kind of verbose right now.</span>
</td></tr>
<tr><td class=line-number>375</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;\n&quot;</span>);
</td></tr>
<tr><td class=line-number>376</td><td class=line>
</td></tr>
<tr><td class=line-number>377</td><td class=line>    <span style='color: #ffd787;'>memcpy</span>(*<span style='color: blue;'>t</span>, <span style='color: blue;'>temporary</span>.data, <span style='color: #ffd787;'>size_of</span>(<span style='font-weight: bold;color: cyan;'>Rectangle</span>));   <span style='font-style: italic;color: #8a8a8a;'>// Copy temporary&#39;s data into t.</span>
</td></tr>
<tr><td class=line-number>378</td><td class=line>
</td></tr>
<tr><td class=line-number>379</td><td class=line>    <span style='color: #ffd787;'>print</span>(<span style='color: #008700;'>&quot;After copy, t is: %\n&quot;</span>, <span style='color: blue;'>t</span>);
</td></tr>
<tr><td class=line-number>380</td><td class=line>
</td></tr>
<tr><td class=line-number>381</td><td class=line>
</td></tr>
<tr><td class=line-number>382</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// You know what? Things don&#39;t need to be structs in order for you to copy them</span>
</td></tr>
<tr><td class=line-number>383</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// in memory like this. It&#39;s just a common thing to do with structs. For example,</span>
</td></tr>
<tr><td class=line-number>384</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// when you remove an element from an [..] array, the element in the last slot is</span>
</td></tr>
<tr><td class=line-number>385</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// copied into the element in the empty slot.</span>
</td></tr>
<tr><td class=line-number>386</td><td class=line>
</td></tr>
<tr><td class=line-number>387</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// I guess this example could be more focused. We kind of left the topic of structs.</span>
</td></tr>
<tr><td class=line-number>388</td><td class=line>    <span style='font-style: italic;color: #8a8a8a;'>// Oh well.</span>
</td></tr>
<tr><td class=line-number>389</td><td class=line>}
</td></tr>
<tr><td class=line-number>390</td><td class=line>
</td></tr>
<tr><td class=line-number>391</td><td class=line>
</td></tr>
<tr><td class=line-number>392</td><td class=line>
</td></tr>
<tr><td class=line-number>393</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>/*</span>
</td></tr>
<tr><td class=line-number>394</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>395</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>    We don&#39;t have reasonable struct literals yet in this language. They are coming soon!</span>
</td></tr>
<tr><td class=line-number>396</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>    When fully implemented, we&#39;ll cover them here.</span>
</td></tr>
<tr><td class=line-number>397</td><td class=line><span style='font-style: italic;color: #8a8a8a;'></span>
</td></tr>
<tr><td class=line-number>398</td><td class=line><span style='font-style: italic;color: #8a8a8a;'> */</span>
</td></tr>
<tr><td class=line-number>399</td><td class=line>
</td></tr>
<tr><td class=line-number>400</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// Let&#39;s do something about anonymous structs in a later chapter.</span>
</td></tr>
<tr><td class=line-number>401</td><td class=line>
</td></tr>
<tr><td class=line-number>402</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// A way to get more magic here: Build sequentially from sphere, to ice cream scoop, to multi-scoop display?</span>
</td></tr>
<tr><td class=line-number>403</td><td class=line><span style='font-style: italic;color: #8a8a8a;'>// Also, format the print output more nicely.</span>
</td></tr>
</table>
